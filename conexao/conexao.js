
/*
BASE CRIADA POR: BLACKZIN DO LUFFY
BASE APRIMORADA POR: PQP VIRUS
𝙾𝚕𝚊 𝚞𝚜𝚞𝚊𝚛𝚒𝚘 𝚍𝚎 𝚋𝚘𝚝𝚜, 𝚎𝚞 𝚜𝚘𝚞 𝚘 𝚅𝙸𝚁𝚄𝚂, 𝚙𝚊𝚛𝚊 𝚚𝚞𝚎𝚖 𝚗𝚊𝚘 𝚖𝚎 𝚌𝚘𝚗𝚑𝚎𝚌𝚎 𝚎𝚞 𝚜𝚘𝚞 𝚘 𝚌𝚛𝚒𝚊𝚍𝚘𝚛 𝚘𝚏𝚒𝚌𝚒𝚊𝚕 𝚍𝚊 𝚅𝙻-𝙱𝙾𝚃, 𝚎 𝚊𝚙𝚛𝚎𝚜𝚎𝚗𝚝𝚘 𝚎𝚜𝚜𝚊 𝚟𝚎𝚛𝚜𝚊𝚘 𝚍𝚊 𝚟𝚕𝚋𝚊𝚜𝚎 𝚌𝚘𝚖 𝚌𝚘𝚖𝚊𝚗𝚍𝚘𝚜 𝚜𝚒𝚖𝚙𝚕𝚎𝚜. 𝚂𝚎𝚒 𝚚𝚞𝚎 𝚗𝚎𝚖 𝚝𝚘𝚍𝚘𝚜 𝚝𝚎𝚖 𝚌𝚘𝚗𝚍𝚒𝚌𝚘𝚎𝚜 𝚍𝚎 𝚌𝚘𝚖𝚙𝚛𝚊𝚛 𝚘𝚞 𝚊𝚕𝚞𝚐𝚊𝚛 𝚞𝚖 𝙱𝚘𝚝, 𝚙𝚘𝚛 𝚒𝚜𝚜𝚘 𝚏𝚘𝚒 𝚌𝚛𝚒𝚊𝚍𝚊 𝚎𝚜𝚜𝚊 𝚟𝚎𝚛𝚜𝚊𝚘.

𝚂𝚒𝚗𝚝𝚊-𝚜𝚎 𝚕𝚒𝚟𝚛𝚎 𝚙𝚛𝚊 𝚎𝚍𝚒𝚝𝚊𝚛 𝚘 𝚗𝚘𝚖𝚎 𝚎 𝚊𝚜 𝚌𝚘𝚒𝚜𝚊𝚜 𝚗𝚘 𝙱𝚘𝚝 𝚎 𝚏𝚊𝚣𝚎𝚛 𝚘𝚚𝚞𝚎 𝚍𝚎𝚜𝚎𝚓𝚊𝚛 𝚌𝚘𝚖 𝚎𝚕𝚊, 𝚙𝚘𝚛𝚎𝚖 𝚍𝚎𝚒𝚡𝚎𝚖 𝚙𝚎𝚕𝚘 𝚖𝚎𝚗𝚘𝚜 𝚖𝚎𝚞𝚜 𝙲𝚁𝙴𝙳𝙸𝚃𝙾𝚂 𝙿𝙾𝚁 𝙶𝙴𝙽𝚃𝙸𝙻𝙴𝚉𝙰 🗿🍷.

𝚂𝚎 𝚝𝚒𝚟𝚎𝚛 𝚊𝚕𝚐𝚞𝚖 𝚙𝚛𝚘𝚋𝚕𝚎𝚖𝚊 𝚏𝚊𝚕𝚎 𝚌𝚘𝚖𝚒𝚐𝚘!

𝙼𝙴𝚄 𝙽𝚄𝙼𝙴𝚁𝙾;

/////
𝚅𝙸𝚁𝚄𝚂
𝚠𝚊.𝚖𝚎/𝟻𝟻𝟾𝟺𝟿𝟿𝟾𝟹𝟿𝟸𝟷𝟸
////


////////////
𝙼𝙴𝚄 𝙸𝙽𝚂𝚃𝙰: @𝚙𝚚𝚙𝚟𝚒𝚛𝚞𝚜
//////


𝙱𝚈𝙴 𝙱𝚈𝙴
( 𝚀𝚄𝙰𝙻𝚀𝚄𝙴𝚁 𝙴𝚁𝚁𝙾 𝙹𝙰 𝚂𝙰𝙱𝙴 ): 𝙱𝚁𝙾𝚃𝙰 𝙽𝙾 𝙿𝚅:
𝚠𝚊.𝚖𝚎/𝟻𝟻𝟾𝟺𝟿𝟿𝟾𝟹𝟿𝟸𝟷𝟸

/// 𝙱𝚈: 𝚅𝙸𝚁𝚄𝚂 \\\\
*/


/// 𝙱𝚈: 𝚅𝙸𝚁𝚄𝚂 \\\\

const fs = require('fs')
const Pino = require('pino')
const chalk = require("chalk")
const cfonts = require('cfonts')

const {
Browsers,
DisconnectReason,
default: makeWASocket,
useMultiFileAuthState,
fetchLatestBaileysVersion
} = require ('@WhiskeySockets/baileys')

// Cores Dos consoles
gren = chalk.hex("#10b911").italic
rose = chalk.hex("#a519c8").italic
rosa = chalk.hex("#ec3185").italic
azul = chalk.hex("#23ddf1").italic
verde = chalk.hex("#36f972").italic
branco = chalk.hex("#ffffff").italic

green = chalk.green.italic
vermelho = chalk.red.italic
amarelo  = chalk.yellow.italic

const settings = JSON.parse(fs.readFileSync("./arquivos/settings.json"))

const p = settings.p
const dono = settings.dono
const nomeBot = settings.nomeBot

const StartBot = async() => {

const { 
version, isLatest
} = await fetchLatestBaileysVersion()

const { 
state, saveCreds 
} = await useMultiFileAuthState('./qrcode')

const banner = cfonts.render(('base vl'),
{
 font: "simple" ,
 align: "center",
 color: ["red"]
})
console.log(banner.string)
  
const sock = makeWASocket({
auth: state,
printQRInTerminal: true,
syncFullHistory: false,
logger: Pino({ level: 'silent'}),
browser: Browsers.macOS('Desktop'),
generateHighQualityLinkPreview: true
})

console.log(rosa(`
Seja Bem Vindo a base vl, criada por blackzin e aprimorada por pqpvirus!
`))

sock.ev.process(
async(events) => {
if(events['connection.update']) {
const update = events['connection.update']
const { connection, lastDisconnect } = update
if(connection === 'close') {
console.log(amarelo('\n[Xi men o bot caiu :( ]\n',
vermelho('Você está desconectado.')))
if(lastDisconnect) {StartBot()}}
if(connection === 'open') {
sock.sendMessage(dono,{text:`Oi virus obrigado por disponibilizar essa base, agora irei criar meu bot 🤧 obrigado a você e ao blackzin`})
console.log(green(`💥BOT CONECTADO💥`))}
} 
  
// credenciais atualizadas
if(events['creds.update']) {
await saveCreds()
}

if(events['chats.delete']) {
console.log(amarelo('\n',`CONVERSAS APAGADAS\n`,(vermelho(events['chats.delete']))))
}

if(events['messaging-history.set']) {
const { chats, contacts, messages 
} =  events['messaging-history.set']
/*console.log(
amarelo(`\n[ ⚡️ HISTÓRICO DE MENSAGENS ⚡️ ]\n`,
amarelo(`CHAT:`,vermelho(`${chats.length}\n`), 
amarelo(`CONTATOS:`, vermelho(`${contacts.length}\n`),
amarelo(`MENSAGEM:`, vermelho(`${messages.length}`))))))}*/
}

if(events['messages.upsert']) {
const mek = events['messages.upsert']
for(const info of mek.messages) {
if (info.message && typeof info.message === 'object') {
const type = Object.keys(info.message)[0];
await sock.readMessages([info.key])

if(events['contacts.update']) {
for(const contact of events['contacts.update']) {
if(typeof contact.imgUrl !== 'undefined') {
  if(info.key.fromMe) return
const newUrl = contact.imgUrl === null? null :
await sock.profilePictureUrl(contact.id).catch(() => null)
console.log(amarelo('\n',`[ 👤 NOVA FOTO 👤 ]\n`,
amarelo(`Usuário:`,vermelho(`${contact.id}\n`,
amarelo(`Foto:`,vermelho(`${newUrl}`))))))}}}

const body = 
(type === 'conversation' && info.message.conversation.startsWith(p)) ? info.message.conversation:
(type === 'extendedTextMessage') && info.message[type].text.startsWith(p) ? info.message[type].text: ''
const budy =
(type === 'conversation') ? info.message.conversation: 
(type === 'extendedTextMessage') ? info.message.extendedTextMessage.text: ''

const from = info.key.remoteJid 
const isGroup = from.endsWith("@g.us")
const sender = isGroup ? info.key.participant: from
const comando = body.slice(1).trim().split(/ +/).shift().toLowerCase()
const isCmd = body.startsWith(p)
const pushname = info.pushName ? info.pushName : nomeBot
const groupMetadata = isGroup ? await sock.groupMetadata(from): ""
const groupName = isGroup ? groupMetadata.subject: ""
const groupDesc = isGroup ? groupMetadata.desc : ""
const args = body.trim().split(/ +/).splice(1)
const q = args.join(' ')

if(!isGroup && isCmd)
console.log(`
${branco(`[ ❗️ COMANDO NO PRIVADO️ ❗ ]`)}
${gren(`[ 👤 ] NOME:`,rose(`${pushname}`))}
${gren(`[ 🤖 ] COMANDO:`,rose(`${comando}`))}`)

if(isGroup && isCmd)
console.log(`
${branco(`[ ️❗️ COMANDO EM GRUPO ❗️️ ]`)}
${gren(`[ 👥️ ] GRUPO:`,rose(`${groupName}`))}
${gren(`[ 👤 ] NOME:`,rose(`${pushname}`))}
${gren(`[ 🤖 ] COMANDO:`,rose(`${comando}`))}`)

if(!isCmd && !isGroup)
console.log(`
${branco(`[ 💬 MENSAGEM NO PRIVADO 💬 ]`)}
${rosa(`[ 👤 ] NOME:`,verde(`${pushname}`))}
${rosa(`[ 💭 ] MENSAGEM:`,verde(`${budy}`))}`)

if(isGroup && !isCmd) 
console.log(`
${branco(`[ 💬 MENSAGEM EM GRUPO 💬 ]`)}
${rosa(`[ 👥️ ] GRUPO:`,verde(`${groupName}`))}
${rosa(`[ 👤 ] NOME:`,verde(`${pushname}`))}
${rosa(`[ 💭 ] MENSAGEM:`,verde(`${budy}`))}`)

}}}})
return sock
}

module.exports = { StartBot , vermelho, amarelo }